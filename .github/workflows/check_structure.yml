name: V√©rification de l'arborescence et des fichiers

on:
  push:
  pull_request:

jobs:
  check-structure:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: V√©rifier l'arborescence
        run: |
          echo "üîç V√©rification de l'arborescence du projet..."

          required_dirs=("site" "site/img" "site/css" "site/js" "src")

          for dir in "${required_dirs[@]}"; do
            if [ ! -d "$dir" ]; then
              echo "‚ùå Erreur : Dossier manquant -> $dir"
              exit 1
            fi
          done

          echo "‚úÖ Arborescence correcte."

      - name: V√©rifier les types de fichiers
        run: |
          echo "üîç V√©rification des fichiers..."

          if find site -type f ! -name "*.html" ! -name "*.php" | grep -q .; then
            echo "‚ùå Erreur : 'site' ne doit contenir que des fichiers .html ou .php"
            exit 1
          fi

          if find site/img -type f ! -name "*.png" ! -name "*.jpg" | grep -q .; then
            echo "‚ùå Erreur : 'img' ne doit contenir que des fichiers .png ou .jpg"
            exit 1
          fi

          if find site/css -type f ! -name "*.css" | grep -q .; then
            echo "‚ùå Erreur : 'css' ne doit contenir que des fichiers .css"
            exit 1
          fi

          if find site/js -type f ! -name "*.js" | grep -q .; then
            echo "‚ùå Erreur : 'js' ne doit contenir que des fichiers .js"
            exit 1
          fi

          echo "‚úÖ V√©rification des fichiers r√©ussie."
